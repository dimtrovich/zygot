!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("php-in-js/modules/array"),require("php-in-js/modules/string"),require("php-in-js/modules/types"),require("php-in-js/modules/url")):"function"==typeof define&&define.amd?define(["php-in-js/modules/array","php-in-js/modules/string","php-in-js/modules/types","php-in-js/modules/url"],t):(n||self).route=t(n.array,n.string,n.types,n.url)}(this,function(n,t,r,e){function i(){return i=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n},i.apply(this,arguments)}var u=/*#__PURE__*/function(){function u(n,t){void 0===n&&(n=!0),this.t=t||("undefined"!=typeof Zygot?Zygot:null==globalThis?void 0:globalThis.Zygot),this.t=i({},this.t,{absolute:n}),this.i=this.t.routes}var o,l,s=u.prototype;return s.current=function(n,t){var r=this.u().name;return n?new RegExp("^"+n.replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(r):r},s.has=function(n){return Object.keys(this.i).includes(this.o(n))},s.make=function(r,i){if(r=(i=Array.prototype.slice.call(arguments)).shift(),r=this.o(r),i=i.shift(),n.in_array(i,[null,void 0,"undefined","null",""],!0)&&(i=[]),!this.has(r)){if(this.t.defaults.throwOnUnavailable)throw new Error("Zygot error: route '"+r+"' is not in the route list.");return t.trim(this.t.url,"/")}var u=this.l(this.i[r],i);if(!this.t.absolute)return t.rtrim(u,"/");var o=e.parse_url(this.t.url);u=u.includes(o.host)?o.scheme+"://"+t.ltrim(u.replace(o.scheme+"://",""),"/"):this.t.url+u;var l=e.parse_url(u),s=l.port||o.port||this.t.port||80,f=l.query||o.query;return t.trim((l.scheme||o.scheme)+"://"+(l.host||o.host)+(80==s?"":":"+s)+(l.path||o.path)+(f?"?"+f:""),"/")},s.l=function(i,u){n.in_array(u,[null,void 0,"undefined","null",""],!0)||r.is_array(u)||(u=[u]),u.length&&r.is_object(u[0])&&(u=u[0]);var o=t.trim(i.domain||"","/")+"/"+t.trim(i.uri,"/");if(o.includes("{locale}")){var l=null;u&&u.locale&&(l=u.locale,delete u.locale),o=this.h(o,l)}var s=o.match(new RegExp(/\{([A-Za-z_?]+)\}/,"g"));return s&&s.forEach(function(i,l){var f=t.str_replace(["{","}","?"],"",i);if(u[f]||(n.in_array(u[l],[null,void 0,"undefined","null",""],!0)?u.id&&!s.includes("{id}")&&(f="id"):f=l),!i.endsWith("?}")&&0!==u[f]&&r.empty(u[f]))throw new Error("'"+f+"' parameter is required");var a=n.in_array(u[f],[null,void 0,"undefined","null"],!0)?"":u[f];o=t.str_replace(i,e.urlencode(a),o),delete u[f]}),r.is_object(u)&&Object.keys(u).length&&(o+="?"+e.http_build_query(u)),(s=o.match(new RegExp(/\([^)]+\)/,"g")))&&s.forEach(function(n,r){var e=String(u[r]);if(!e.match(new RegExp("^"+n+"$","g")))throw new Error("Zygot error: Invalid parameter type: '"+e+"'.");var i=t.strpos(o,n);o=t.substr_replace(o,e,i,t.strlen(n))}),"/"+t.ltrim(o,"/")},s.h=function(r,e){return!1===t.strpos(r,"{locale}")?r:(null!==e&&(n.in_array(e,this.t.defaults.supportedLocales||[],!0)||(e=null)),null===e&&(e=this.t.defaults.locale||"en"),t.str_replace("{locale}",e,r))},s.o=function(n){var t=this.t.defaults.routeNamePrefix||null;return t&&r.is_string(t)?t+(n=n.replace(RegExp("^"+t,"i"),"")):n},s.v=function(n,r){if(!n.methods.includes("GET"))return!1;r=t.trim(r,"/");var e=n.uri.replace(/:([\w]+)/,function(n){return"([^/]+)"}),i=new RegExp("^"+e+"$","i"),u=r.match(i);return null!=u&&(u.shift(),u)},s.u=function(n){var t=this;n?this.t.absolute&&n.startsWith("/")&&(n=this.p().host+n):n=this.g();var r={},e=Object.entries(this.i).find(function(e){return r=t.v(e[1],n)})||[void 0,void 0];return i({name:e[0]},r,{route:e[1]})},s.p=function(){var n,t,r,e,i,u,o="undefined"!=typeof window?window.location:{},l=o.host,s=o.pathname,f=o.search;return{host:null!=(n=null==(t=this.t.location)?void 0:t.host)?n:void 0===l?"":l,pathname:null!=(r=null==(e=this.t.location)?void 0:e.pathname)?r:void 0===s?"":s,search:null!=(i=null==(u=this.t.location)?void 0:u.search)?i:void 0===f?"":f}},s.g=function(){var n=this.p(),t=n.pathname,r=n.search;return(this.t.absolute?n.host+t:t.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+r},o=u,(l=[{key:"params",get:function(){var n=this.u();return i({},n.params,n.query)}}])&&function(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,"symbol"==typeof(i=function(n,t){if("object"!=typeof n||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var e=r.call(n,"string");if("object"!=typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(e.key))?i:String(i),e)}var i}(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),u}();return function(n,t,r,e){var i=new u(r,e);return n?i.make(n,t):i}});
