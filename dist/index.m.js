import{in_array as t}from"php-in-js/modules/array";import{trim as r,rtrim as n,ltrim as i,str_replace as e,strpos as o,substr_replace as u,strlen as l}from"php-in-js/modules/string";import{is_array as s,is_object as a,empty as f,is_string as h}from"php-in-js/modules/types";import{parse_url as v,urlencode as d,http_build_query as c}from"php-in-js/modules/url";function p(){return p=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},p.apply(this,arguments)}var g=/*#__PURE__*/function(){function g(t,r){void 0===t&&(t=!0),this.t=r||("undefined"!=typeof Zygot?Zygot:null==globalThis?void 0:globalThis.Zygot),this.t=p({},this.t,{absolute:t}),this.i=this.t.routes}var m,w,y=g.prototype;return y.current=function(t,r){var n=this.o().name;return t?new RegExp("^"+t.replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n):n},y.has=function(t){return Object.keys(this.i).includes(this.u(t))},y.make=function(e,o){if(e=(o=Array.prototype.slice.call(arguments)).shift(),e=this.u(e),o=o.shift(),t(o,[null,void 0,"undefined","null",""],!0)&&(o=[]),!this.has(e)){if(this.t.defaults.throwOnUnavailable)throw new Error("Zygot error: route '"+e+"' is not in the route list.");return r(this.t.url,"/")}var u=this.l(this.i[e],o);if(!this.t.absolute)return n(u,"/");var l=v(this.t.url);u=u.includes(l.host)?l.scheme+"://"+i(u.replace(l.scheme+"://",""),"/"):this.t.url+u;var s=v(u),a=s.port||l.port||this.t.port||80,f=s.query||l.query;return r((s.scheme||l.scheme)+"://"+(s.host||l.host)+(80==a?"":":"+a)+(s.path||l.path)+(f?"?"+f:""),"/")},y.l=function(n,h){t(h,[null,void 0,"undefined","null",""],!0)||s(h)||(h=[h]),h.length&&a(h[0])&&(h=h[0]);var v=r(n.domain||"","/")+"/"+r(n.uri,"/");if(v.includes("{locale}")){var p=null;h&&h.locale&&(p=h.locale,delete h.locale),v=this.h(v,p)}var g=v.match(new RegExp(/\{([A-Za-z_?]+)\}/,"g"));return g&&g.forEach(function(r,n){var i=e(["{","}","?"],"",r);if(h[i]||(t(h[n],[null,void 0,"undefined","null",""],!0)?h.id&&!g.includes("{id}")&&(i="id"):i=n),!r.endsWith("?}")&&0!==h[i]&&f(h[i]))throw new Error("'"+i+"' parameter is required");var o=t(h[i],[null,void 0,"undefined","null"],!0)?"":h[i];v=e(r,d(o),v),delete h[i]}),a(h)&&Object.keys(h).length&&(v+="?"+c(h)),(g=v.match(new RegExp(/\([^)]+\)/,"g")))&&g.forEach(function(t,r){var n=String(h[r]);if(!n.match(new RegExp("^"+t+"$","g")))throw new Error("Zygot error: Invalid parameter type: '"+n+"'.");var i=o(v,t);v=u(v,n,i,l(t))}),"/"+i(v,"/")},y.h=function(r,n){return!1===o(r,"{locale}")?r:(null!==n&&(t(n,this.t.defaults.supportedLocales||[],!0)||(n=null)),null===n&&(n=this.t.defaults.locale||"en"),e("{locale}",n,r))},y.u=function(t){var r=this.t.defaults.routeNamePrefix||null;return r&&h(r)?r+(t=t.replace(RegExp("^"+r,"i"),"")):t},y.v=function(t,n){if(!t.methods.includes("GET"))return!1;n=r(n,"/");var i=t.uri.replace(/:([\w]+)/,function(t){return"([^/]+)"}),e=new RegExp("^"+i+"$","i"),o=n.match(e);return null!=o&&(o.shift(),o)},y.o=function(t){var r=this;t?this.t.absolute&&t.startsWith("/")&&(t=this.p().host+t):t=this.g();var n={},i=Object.entries(this.i).find(function(i){return n=r.v(i[1],t)})||[void 0,void 0];return p({name:i[0]},n,{route:i[1]})},y.p=function(){var t,r,n,i,e,o,u="undefined"!=typeof window?window.location:{},l=u.host,s=u.pathname,a=u.search;return{host:null!=(t=null==(r=this.t.location)?void 0:r.host)?t:void 0===l?"":l,pathname:null!=(n=null==(i=this.t.location)?void 0:i.pathname)?n:void 0===s?"":s,search:null!=(e=null==(o=this.t.location)?void 0:o.search)?e:void 0===a?"":a}},y.g=function(){var t=this.p(),r=t.pathname,n=t.search;return(this.t.absolute?t.host+r:r.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+n},m=g,(w=[{key:"params",get:function(){var t=this.o();return p({},t.params,t.query)}}])&&function(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,"symbol"==typeof(e=function(t,r){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key))?e:String(e),i)}var e}(m.prototype,w),Object.defineProperty(m,"prototype",{writable:!1}),g}();function m(t,r,n,i){var e=new g(n,i);return t?e.make(t,r):e}export{m as default};
